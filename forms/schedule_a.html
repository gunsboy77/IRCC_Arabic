<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>الجدول (أ) - الخلفية / الإقرار</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f7fa;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            gap: 20px;
        }
        .main-content {
            flex: 3;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        .saved-sessions {
            flex: 1;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            max-height: 600px;
            overflow-y: auto;
        }
        h1, h2, h3 {
            color: #2c3e50;
        }
        h1 {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 2px solid #eee;
        }
        .section {
            margin-bottom: 30px;
            padding: 15px;
            background: #fff;
            border-radius: 5px;
            border-left: 4px solid #3498db;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: right;
        }
        th {
            background-color: #f2f2f2;
        }
        input[type="text"], 
        input[type="date"], 
        input[type="email"], 
        textarea, 
        select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
            font-family: inherit;
        }
        textarea {
            min-height: 100px;
            resize: vertical;
        }
        .checkbox-item {
            margin: 10px 0;
            padding: 10px;
            border: 1px solid #eee;
            border-radius: 4px;
        }
        .checkbox-item label {
            font-weight: bold;
            display: block;
            margin-bottom: 5px;
        }
        .checkbox-item .subtext {
            font-size: 0.9em;
            color: #666;
            margin: 5px 0;
        }
        .required {
            color: red;
        }
        .btn {
            background-color: #3498db;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
            transition: background-color 0.3s;
        }
        .btn:hover {
            background-color: #2980b9;
        }
        .btn-danger {
            background-color: #e74c3c;
        }
        .btn-danger:hover {
            background-color: #c0392b;
        }
        .btn-success {
            background-color: #2ecc71;
        }
        .btn-success:hover {
            background-color: #27ae60;
        }
        .save-section {
            background-color: #e7f4fe;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
            text-align: center;
        }
        .instructions {
            background-color: #fff8e1;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            border-left: 4px solid #ffc107;
        }
        .yes-no-group {
            display: flex;
            gap: 15px;
            margin: 10px 0;
        }
        .session-list {
            list-style-type: none;
            padding: 0;
        }
        .session-item {
            padding: 10px;
            margin: 8px 0;
            background: #f8f9fa;
            border-radius: 4px;
            border-left: 4px solid #3498db;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .session-item:hover {
            background: #e9ecef;
        }
        .session-name {
            cursor: pointer;
            flex-grow: 1;
        }
        .session-actions {
            display: flex;
            gap: 5px;
        }
        .session-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        @media print {
            .save-section, .instructions, button, .saved-sessions {
                display: none;
            }
        }
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="main-content">
            <h1>الجدول (أ) - الخلفية / الإقرار</h1>
            
            <div class="instructions">
                <h3>تعليمات هامة:</h3>
                <p>1. يجب على مقدم الطلب الرئيسي والزوج/الشريك والأطفال المعالين الذين تبلغ أعمارهم 18 سنة أو أكثر تعبئة هذا النموذج.</p>
                <p>2. لحفظ البيانات، املأ الحقول ثم اضغط على زر "حفظ البيانات".</p>
                <p>3. لاسترجاع البيانات المحفوظة سابقاً، اكتب اسم الجلسة ثم اضغط على زر "تحميل البيانات" أو انقر على الجلسة من القائمة.</p>
                <p>4. يمكنك طباعة النموذج بعد تعبئته باستخدام أمر الطباعة في متصفحك.</p>
            </div>

            <form id="scheduleAForm">
                <!-- المعلومات الأساسية -->
                <div class="section">
                    <h2>المعلومات الأساسية</h2>
                    
                    <div>
                        <input type="radio" id="principalApplicant" name="applicantType" value="principal" checked>
                        <label for="principalApplicant">مقدم الطلب الرئيسي</label>
                        <input type="radio" id="familyMember" name="applicantType" value="family">
                        <label for="familyMember">الزوج/الشريك أو الطفل المعال الذي يبلغ 18 سنة أو أكثر</label>
                    </div>
                    
                    <table>
                        <tr>
                            <th>1. الاسم الكامل</th>
                            <td>
                                <input type="text" id="familyName" name="familyName" placeholder="اسم العائلة" required>
                                <input type="text" id="givenNames" name="givenNames" placeholder="الاسم الأول (الأسماء)" required>
                            </td>
                        </tr>
                        <tr>
                            <th>2. الاسم الكامل بلغتك الأصلية أو كتابتك</th>
                            <td><input type="text" id="nativeName" name="nativeName"></td>
                        </tr>
                        <tr>
                            <th>3. تاريخ الميلاد (YYYY-MM-DD)</th>
                            <td><input type="date" id="dateOfBirth" name="dateOfBirth" required></td>
                        </tr>
                    </table>
                    
                    <h3>4. التفاصيل الشخصية لأبيك</h3>
                    <table>
                        <tr>
                            <th>اسم العائلة</th>
                            <th>الاسم الأول (الأسماء)</th>
                            <th>تاريخ الميلاد (YYYY-MM-DD)</th>
                            <th>مدينة الميلاد</th>
                            <th>بلد الميلاد</th>
                            <th>تاريخ الوفاة إذا متوفي (YYYY-MM-DD)</th>
                        </tr>
                        <tr>
                            <td><input type="text" name="fatherFamilyName"></td>
                            <td><input type="text" name="fatherGivenNames"></td>
                            <td><input type="date" name="fatherDOB"></td>
                            <td><input type="text" name="fatherBirthCity"></td>
                            <td><input type="text" name="fatherBirthCountry"></td>
                            <td><input type="date" name="fatherDeathDate"></td>
                        </tr>
                    </table>
                    
                    <h3>5. التفاصيل الشخصية لأمك</h3>
                    <table>
                        <tr>
                            <th>اسم العائلة عند الولادة</th>
                            <th>الاسم الأول (الأسماء)</th>
                            <th>تاريخ الميلاد (YYYY-MM-DD)</th>
                            <th>مدينة الميلاد</th>
                            <th>بلد الميلاد</th>
                            <th>تاريخ الوفاة إذا متوفي (YYYY-MM-DD)</th>
                        </tr>
                        <tr>
                            <td><input type="text" name="motherFamilyName"></td>
                            <td><input type="text" name="motherGivenNames"></td>
                            <td><input type="date" name="motherDOB"></td>
                            <td><input type="text" name="motherBirthCity"></td>
                            <td><input type="text" name="motherBirthCountry"></td>
                            <td><input type="date" name="motherDeathDate"></td>
                        </tr>
                    </table>
                </div>

                <!-- الأسئلة -->
                <div class="section">
                    <h2>6. هل سبق لك، أو إذا كنت مقدم الطلب الرئيسي، أي من أفراد أسرتك المدرجين في طلبك للإقامة الدائمة في كندا، أن:</h2>
                    
                    <table>
                        <tr>
                            <th>السؤال</th>
                            <th>نعم</th>
                            <th>لا</th>
                            <th>التفاصيل (إذا كانت الإجابة نعم)</th>
                        </tr>
                        <!-- سيتم إنشاء الأسئلة ديناميكيًا باستخدام JavaScript -->
                    </table>
                </div>

                <!-- التعليم -->
                <div class="section">
                    <h2>7. التعليم</h2>
                    
                    <h3>أعط عدد سنوات الدراسة التي أكملتها بنجاح لكل من مستويات التعليم التالية:</h3>
                    <table>
                        <tr>
                            <th>المدرسة الابتدائية/الأساسية</th>
                            <th>المدرسة الثانوية</th>
                            <th>الجامعة/الكلية</th>
                            <th>مدرسة مهنية أو أي مدرسة ما بعد الثانوية أخرى</th>
                        </tr>
                        <tr>
                            <td><input type="number" name="elementaryYears" min="0"></td>
                            <td><input type="number" name="secondaryYears" min="0"></td>
                            <td><input type="number" name="universityYears" min="0"></td>
                            <td><input type="number" name="tradeYears" min="0"></td>
                        </tr>
                    </table>
                    
                    <h3>أعط تفاصيل كاملة عن جميع التعليم الثانوي وما بعد الثانوي (بما في ذلك الجامعة والكلية والتدريب المهني) الذي حصلت عليه:</h3>
                    <table id="educationTable">
                        <tr>
                            <th>من (YYYY-MM)</th>
                            <th>إلى (YYYY-MM)</th>
                            <th>اسم المؤسسة</th>
                            <th>المدينة والبلد</th>
                            <th>نوع الشهادة أو الدبلوم الممنوح</th>
                            <th>مجال الدراسة</th>
                        </tr>
                        <tr>
                            <td><input type="text" name="eduFrom1"></td>
                            <td><input type="text" name="eduTo1"></td>
                            <td><input type="text" name="eduInstitution1"></td>
                            <td><input type="text" name="eduLocation1"></td>
                            <td><input type="text" name="eduCertificate1"></td>
                            <td><input type="text" name="eduField1"></td>
                        </tr>
                    </table>
                    <button type="button" class="btn" onclick="addEducationRow()">+ إضافة صف</button>
                </div>

                <!-- التاريخ الشخصي -->
                <div class="section">
                    <h2>8. التاريخ الشخصي</h2>
                    <p>قدم تفاصيل تاريخك الشخصي منذ سن 18، أو السنوات العشر الماضية، أيهما أحدث. ابدأ بأحدث المعلومات.</p>
                    
                    <table id="personalHistoryTable">
                        <tr>
                            <th>من (YYYY-MM)</th>
                            <th>إلى (YYYY-MM)</th>
                            <th>النشاط</th>
                            <th>المدينة والبلد</th>
                            <th>الحالة في البلد</th>
                            <th>اسم الشركة، صاحب العمل، المدرسة، المنشأة، حسب الاقتضاء</th>
                        </tr>
                        <tr>
                            <td><input type="text" name="historyFrom1"></td>
                            <td><input type="text" name="historyTo1"></td>
                            <td><input type="text" name="historyActivity1"></td>
                            <td><input type="text" name="historyLocation1"></td>
                            <td><input type="text" name="historyStatus1"></td>
                            <td><input type="text" name="historyEntity1"></td>
                        </tr>
                    </table>
                    <button type="button" class="btn" onclick="addPersonalHistoryRow()">+ إضافة صف</button>
                </div>

                <!-- العضوية في المنظمات -->
                <div class="section">
                    <h2>9. العضوية أو الارتباط بالمنظمات</h2>
                    <p>ما هي المنظمات التي دعمتها، أو كنت عضوًا فيها، أو ارتبطت بها؟ قم بتضمين أي منظمة سياسية، اجتماعية، شبابية أو طلابية، نقابات عمالية وجمعيات مهنية.</p>
                    
                    <table id="organizationsTable">
                        <tr>
                            <th>من (YYYY-MM)</th>
                            <th>إلى (YYYY-MM)</th>
                            <th>اسم المنظمة</th>
                            <th>نوع المنظمة</th>
                            <th>الأنشطة و/أو المناصب التي شغلتها داخل المنظمة</th>
                            <th>المدينة والبلد</th>
                        </tr>
                        <tr>
                            <td><input type="text" name="orgFrom1"></td>
                            <td><input type="text" name="orgTo1"></td>
                            <td><input type="text" name="orgName1"></td>
                            <td><input type="text" name="orgType1"></td>
                            <td><input type="text" name="orgActivities1"></td>
                            <td><input type="text" name="orgLocation1"></td>
                        </tr>
                    </table>
                    <button type="button" class="btn" onclick="addOrganizationRow()">+ إضافة صف</button>
                </div>

                <!-- المناصب الحكومية -->
                <div class="section">
                    <h2>10. المناصب الحكومية</h2>
                    <p>اذكر أي مناصب حكومية شغلتها (مثل موظف حكومي، قاض، ضابط شرطة، موظف في منظمة أمنية).</p>
                    
                    <table id="governmentTable">
                        <tr>
                            <th>من (YYYY-MM)</th>
                            <th>إلى (YYYY-MM)</th>
                            <th>البلد ومستوى الولاية القضائية (مثل وطني، إقليمي، بلدي)</th>
                            <th>القسم/الفرع</th>
                            <th>الأنشطة و/أو المناصب التي شغلتها</th>
                        </tr>
                        <tr>
                            <td><input type="text" name="govFrom1"></td>
                            <td><input type="text" name="govTo1"></td>
                            <td><input type="text" name="govJurisdiction1"></td>
                            <td><input type="text" name="govDepartment1"></td>
                            <td><input type="text" name="govActivities1"></td>
                        </tr>
                    </table>
                    <button type="button" class="btn" onclick="addGovernmentRow()">+ إضافة صف</button>
                </div>

                <!-- الخدمة العسكرية -->
                <div class="section">
                    <h2>11. الخدمة العسكرية و/أو شبه العسكرية</h2>
                    <p>قدم أدناه تفاصيل كاملة عن الخدمة العسكرية و/أو شبه العسكرية لكل من البلدان التي خدمت في قواتها المسلحة.</p>
                    
                    <div id="militaryService">
                        <h3>اسم البلد</h3>
                        <table>
                            <tr>
                                <th>من (YYYY-MM)</th>
                                <th>إلى (YYYY-MM)</th>
                                <th>فرع الخدمة، أرقام الوحدات وأسماء ضباطك القادة</th>
                                <th>الرتب</th>
                                <th>تواريخ وأماكن أي قتال نشط</th>
                                <th>سبب انتهاء الخدمة</th>
                            </tr>
                            <tr>
                                <td><input type="text" name="milFrom1"></td>
                                <td><input type="text" name="milTo1"></td>
                                <td><input type="text" name="milBranch1"></td>
                                <td><input type="text" name="milRank1"></td>
                                <td><input type="text" name="milCombat1"></td>
                                <td><input type="text" name="milEndReason1"></td>
                            </tr>
                        </table>
                    </div>
                    <button type="button" class="btn" onclick="addMilitaryService()">+ إضافة خدمة عسكرية</button>
                </div>

                <!-- العناوين -->
                <div class="section">
                    <h2>12. العناوين</h2>
                    <p>اذكر جميع العناوين التي عشت فيها منذ عيد ميلادك الثامن عشر أو السنوات العشر الماضية، أيهما أحدث. لا تستخدم عناوين صندوق البريد.</p>
                    
                    <table id="addressesTable">
                        <tr>
                            <th>من (YYYY-MM)</th>
                            <th>إلى (YYYY-MM)</th>
                            <th>الشارع والرقم</th>
                            <th>المدينة</th>
                            <th>المقاطعة، الولاية أو المنطقة</th>
                            <th>الرمز البريدي</th>
                            <th>البلد</th>
                        </tr>
                        <tr>
                            <td><input type="text" name="addrFrom1"></td>
                            <td><input type="text" name="addrTo1"></td>
                            <td><input type="text" name="addrStreet1"></td>
                            <td><input type="text" name="addrCity1"></td>
                            <td><input type="text" name="addrProvince1"></td>
                            <td><input type="text" name="addrPostalCode1"></td>
                            <td><input type="text" name="addrCountry1"></td>
                        </tr>
                    </table>
                    <button type="button" class="btn" onclick="addAddressRow()">+ إضافة عنوان</button>
                </div>

                <!-- الإقرار -->
                <div class="section">
                    <h2>الإقرار</h2>
                    <p>أقر بأن المعلومات التي قدمتها صحيحة وكاملة وصحيحة.</p>
                    
                    <table>
                        <tr>
                            <th>التوقيع</th>
                            <td><input type="text" id="signature" name="signature" required></td>
                        </tr>
                        <tr>
                            <th>التاريخ (YYYY-MM-DD)</th>
                            <td><input type="date" id="signatureDate" name="signatureDate" required></td>
                        </tr>
                    </table>
                </div>

                <!-- حفظ البيانات -->
                <div class="save-section">
                    <h2>حفظ البيانات واسترجاعها</h2>
                    <p>لحفظ البيانات، املأ الحقول ثم اضغط على زر "حفظ البيانات".</p>
                    <p>لاسترجاع البيانات المحفوظة سابقاً، اكتب اسم الجلسة ثم اضغط على زر "تحميل البيانات" أو انقر على الجلسة من القائمة.</p>
                    
                    <div>
                        <input type="text" id="saveHandle" placeholder="اسم الجلسة للحفظ/التحميل">
                        <button type="button" class="btn btn-success" onclick="saveData()">حفظ البيانات</button>
                        <button type="button" class="btn" onclick="loadData()">تحميل البيانات</button>
                    </div>
                    
                    <p id="saveMessage" style="color: green; margin-top: 10px;"></p>
                </div>
                
                <div style="text-align: center; margin-top: 30px;">
                    <button type="button" class="btn" onclick="window.print()">طباعة النموذج</button>
                    <button type="reset" class="btn btn-danger">مسح النموذج</button>
                </div>
            </form>
        </div>

        <!-- قسم الجلسات المحفوظة -->
        <div class="saved-sessions">
            <div class="session-header">
                <h2>الجلسات المحفوظة</h2>
                <button type="button" class="btn" onclick="refreshSessions()">🔄 تحديث</button>
            </div>
            <p>انقر على أي جلسة لتحميلها:</p>
            <ul id="sessionsList" class="session-list">
                <!-- سيتم ملء هذا القسم بالجلسات المحفوظة -->
            </ul>
        </div>
    </div>

    <script>
        // الأسئلة للقسم 6
        const questions = [
            "أ) تم إدانتك بجريمة أو مخالفة في كندا لم يتم منحك عفو عنها بموجب قانون السجلات الجنائية الكندي؟",
            "ب) تم إدانتك، أو هل أنت حالياً متهم، أو قيد المحاكمة، أو طرف في جريمة أو مخالفة، أو موضوع أي إجراءات جنائية في أي بلد أو إقليم آخر؟",
            "ج) قدمت مطالبات سابقة للحماية كلاجئ في كندا أو في مكتب تأشيرات كندي في الخارج، في أي بلد (بلدان) أو إقليم (أقاليم) أخرى، أو مع مفوضية الأمم المتحدة السامية لشؤون اللاجئين (UNHCR)؟",
            "د) تم رفض منحك وضع لاجئ، أو تأشيرة مهاجر أو مقيم دائم (بما في ذلك شهادة الاختيار في كيبيك (CSQ) أو طلب لبرنامج المرشح الإقليمي) أو تأشيرة زائر أو مقيم مؤقت، إلى كندا أو أي بلد أو إقليم آخر؟",
            "هـ) تم رفض دخولك، أو أمرتك السلطات بمغادرة كندا أو أي بلد أو إقليم آخر؟",
            "و) شاركت في فعل إبادة جماعية، أو جريمة حرب، أو في ارتكاب جريمة ضد الإنسانية؟",
            "ز) استخدمت، خططت، أو دافعت عن استخدام الكفاح المسلح أو العنف لتحقيق أهداف سياسية أو دينية أو اجتماعية؟",
            "ح) ارتبطت بمجموعة استخدمت، أو تستخدم، أو دافعت، أو تدافع عن استخدام الكفاح المسلح أو العنف لتحقيق أهداف سياسية أو دينية أو اجتماعية؟",
            "ط) كنت عضوًا في منظمة تشارك أو كانت تشارك في نشاط يشكل جزءًا من نمط النشاط الإجرامي؟",
            "ي) تم احتجازك، أو سجنك، أو وضعك في السجن؟",
            "ك) أصبت بأي مرض خطير أو اضطراب جسدي أو عقلي؟"
        ];

        // إنشاء جدول الأسئلة ديناميكيًا
        document.addEventListener('DOMContentLoaded', function() {
            const questionsTable = document.querySelector('.section:nth-child(2) table');
            
            questions.forEach((question, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${question}</td>
                    <td><input type="radio" name="q${index}" value="yes"></td>
                    <td><input type="radio" name="q${index}" value="no" checked></td>
                    <td><textarea name="q${index}Details"></textarea></td>
                `;
                questionsTable.appendChild(row);
            });
        });

        // وظائف إضافة الصفوف للجداول
        let educationCount = 1;
        function addEducationRow() {
            educationCount++;
            const table = document.getElementById('educationTable');
            const row = table.insertRow();
            row.innerHTML = `
                <td><input type="text" name="eduFrom${educationCount}"></td>
                <td><input type="text" name="eduTo${educationCount}"></td>
                <td><input type="text" name="eduInstitution${educationCount}"></td>
                <td><input type="text" name="eduLocation${educationCount}"></td>
                <td><input type="text" name="eduCertificate${educationCount}"></td>
                <td><input type="text" name="eduField${educationCount}"></td>
            `;
        }

        let historyCount = 1;
        function addPersonalHistoryRow() {
            historyCount++;
            const table = document.getElementById('personalHistoryTable');
            const row = table.insertRow();
            row.innerHTML = `
                <td><input type="text" name="historyFrom${historyCount}"></td>
                <td><input type="text" name="historyTo${historyCount}"></td>
                <td><input type="text" name="historyActivity${historyCount}"></td>
                <td><input type="text" name="historyLocation${historyCount}"></td>
                <td><input type="text" name="historyStatus${historyCount}"></td>
                <td><input type="text" name="historyEntity${historyCount}"></td>
            `;
        }

        let orgCount = 1;
        function addOrganizationRow() {
            orgCount++;
            const table = document.getElementById('organizationsTable');
            const row = table.insertRow();
            row.innerHTML = `
                <td><input type="text" name="orgFrom${orgCount}"></td>
                <td><input type="text" name="orgTo${orgCount}"></td>
                <td><input type="text" name="orgName${orgCount}"></td>
                <td><input type="text" name="orgType${orgCount}"></td>
                <td><input type="text" name="orgActivities${orgCount}"></td>
                <td><input type="text" name="orgLocation${orgCount}"></td>
            `;
        }

        let govCount = 1;
        function addGovernmentRow() {
            govCount++;
            const table = document.getElementById('governmentTable');
            const row = table.insertRow();
            row.innerHTML = `
                <td><input type="text" name="govFrom${govCount}"></td>
                <td><input type="text" name="govTo${govCount}"></td>
                <td><input type="text" name="govJurisdiction${govCount}"></td>
                <td><input type="text" name="govDepartment${govCount}"></td>
                <td><input type="text" name="govActivities${govCount}"></td>
            `;
        }

        let militaryCount = 1;
        function addMilitaryService() {
            militaryCount++;
            const div = document.getElementById('militaryService');
            const newService = document.createElement('div');
            newService.innerHTML = `
                <h3>اسم البلد</h3>
                <table>
                    <tr>
                        <th>من (YYYY-MM)</th>
                        <th>إلى (YYYY-MM)</th>
                        <th>فرع الخدمة، أرقام الوحدات وأسماء ضباطك القادة</th>
                        <th>الرتب</th>
                        <th>تواريخ وأماكن أي قتال نشط</th>
                        <th>سبب انتهاء الخدمة</th>
                    </tr>
                    <tr>
                        <td><input type="text" name="milFrom${militaryCount}"></td>
                        <td><input type="text" name="milTo${militaryCount}"></td>
                        <td><input type="text" name="milBranch${militaryCount}"></td>
                        <td><input type="text" name="milRank${militaryCount}"></td>
                        <td><input type="text" name="milCombat${militaryCount}"></td>
                        <td><input type="text" name="milEndReason${militaryCount}"></td>
                    </tr>
                </table>
            `;
            div.parentNode.insertBefore(newService, div.nextSibling);
        }

        let addrCount = 1;
        function addAddressRow() {
            addrCount++;
            const table = document.getElementById('addressesTable');
            const row = table.insertRow();
            row.innerHTML = `
                <td><input type="text" name="addrFrom${addrCount}"></td>
                <td><input type="text" name="addrTo${addrCount}"></td>
                <td><input type="text" name="addrStreet${addrCount}"></td>
                <td><input type="text" name="addrCity${addrCount}"></td>
                <td><input type="text" name="addrProvince${addrCount}"></td>
                <td><input type="text" name="addrPostalCode${addrCount}"></td>
                <td><input type="text" name="addrCountry${addrCount}"></td>
            `;
        }

        // حفظ البيانات في localStorage
        function saveData() {
            const handle = document.getElementById('saveHandle').value.trim();
            if (!handle) {
                alert('يرجى إدخال اسم للحفظ');
                return;
            }
            
            const formData = {};
            const formElements = document.getElementById('scheduleAForm').elements;
            
            for (let i = 0; i < formElements.length; i++) {
                const element = formElements[i];
                if (element.name) {
                    if (element.type === 'radio') {
                        if (element.checked) {
                            formData[element.name] = element.value;
                        }
                    } else if (element.type === 'checkbox') {
                        formData[element.name] = element.checked;
                    } else {
                        formData[element.name] = element.value;
                    }
                }
            }
            
            // إضافة معلومات إضافية عن الجلسة
            const sessionInfo = {
                data: formData,
                timestamp: new Date().toISOString(),
                name: handle
            };
            
            localStorage.setItem(`scheduleA_${handle}`, JSON.stringify(sessionInfo));
            document.getElementById('saveMessage').textContent = 'تم حفظ البيانات بنجاح!';
            
            // تحديث قائمة الجلسات
            refreshSessions();
            
            setTimeout(() => {
                document.getElementById('saveMessage').textContent = '';
            }, 3000);
        }
        
        // تحميل البيانات من localStorage
        function loadData(handle = null) {
            const handleToLoad = handle || document.getElementById('saveHandle').value.trim();
            if (!handleToLoad) {
                alert('يرجى إدخال اسم للتحميل');
                return;
            }
            
            const savedData = localStorage.getItem(`scheduleA_${handleToLoad}`);
            if (!savedData) {
                alert('لا توجد بيانات محفوظة بهذا الاسم');
                return;
            }
            
            const sessionInfo = JSON.parse(savedData);
            const formData = sessionInfo.data;
            const formElements = document.getElementById('scheduleAForm').elements;
            
            for (let i = 0; i < formElements.length; i++) {
                const element = formElements[i];
                if (element.name && formData[element.name] !== undefined) {
                    if (element.type === 'radio') {
                        if (element.value === formData[element.name]) {
                            element.checked = true;
                        }
                    } else if (element.type === 'checkbox') {
                        element.checked = formData[element.name];
                    } else {
                        element.value = formData[element.name];
                    }
                }
            }
            
            document.getElementById('saveMessage').textContent = 'تم تحميل البيانات بنجاح!';
            
            setTimeout(() => {
                document.getElementById('saveMessage').textContent = '';
            }, 3000);
        }
        
        // عرض الجلسات المحفوظة
        function refreshSessions() {
            const sessionsList = document.getElementById('sessionsList');
            sessionsList.innerHTML = '';
            
            let hasSessions = false;
            
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key.startsWith('scheduleA_')) {
                    hasSessions = true;
                    const sessionInfo = JSON.parse(localStorage.getItem(key));
                    const handle = key.replace('scheduleA_', '');
                    
                    const li = document.createElement('li');
                    li.className = 'session-item';
                    
                    const sessionDate = new Date(sessionInfo.timestamp).toLocaleString('ar-EG');
                    
                    li.innerHTML = `
                        <span class="session-name" onclick="loadData('${handle}')">
                            ${handle} (${sessionDate})
                        </span>
                        <div class="session-actions">
                            <button class="btn btn-danger" onclick="deleteSession('${handle}')">×</button>
                        </div>
                    `;
                    
                    sessionsList.appendChild(li);
                }
            }
            
            if (!hasSessions) {
                sessionsList.innerHTML = '<li>لا توجد جلسات محفوظة</li>';
            }
        }
        
        // حذف جلسة
        function deleteSession(handle) {
            if (confirm(`هل أنت متأكد من أنك تريد حذف الجلسة "${handle}"؟`)) {
                localStorage.removeItem(`scheduleA_${handle}`);
                refreshSessions();
            }
        }
        
        // تحديث قائمة الجلسات عند تحميل الصفحة
        document.addEventListener('DOMContentLoaded', function() {
            refreshSessions();
        });
    </script>
</body>
</html>
